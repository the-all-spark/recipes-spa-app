import { useRef, useEffect, Dispatch, SetStateAction } from 'react';
import { useTheme } from '@mui/material/styles';

import H2Text from '@/components/H2Text/H2Text';
import {
  PopupBackgroundContainer,
  PopupBlockContainer,
  PopupContentContainer,
} from '@/components/LogoutPopup/LogoutPopup.styled';

interface LogoutPopupProps {
  isPopupOpen: boolean;
  setIsPopupOpen: Dispatch<SetStateAction<boolean>>;
}

const LogoutPopup = ({ isPopupOpen, setIsPopupOpen }: LogoutPopupProps) => {
  let timerRef = useRef<ReturnType<typeof setTimeout> | null>(null);
  const theme = useTheme();

  useEffect(() => {
    if (isPopupOpen) {
      timerRef.current = setTimeout(() => {
        setIsPopupOpen(!isPopupOpen);
      }, 2000);
    }
    return () => {
      if (timerRef.current) {
        clearTimeout(timerRef.current);
      }
    };
  }, [isPopupOpen]);

  return (
    <PopupBackgroundContainer
      sx={{
        display: isPopupOpen ? 'block' : 'none',
      }}
    >
      <PopupBlockContainer
        sx={{
          display: isPopupOpen ? 'flex' : 'none',
        }}
      >
        <PopupContentContainer>
          <svg width="100" height="135" viewBox="0 0 100 135" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M22.2035 37.1568C22.749 38.1735 23.1244 38.4611 23.6039 39.152L24.8316 40.6398C25.062 41.1384 25.4329 41.5266 25.5991 42.0722C25.9998 43.1057 26.4368 44.1973 26.5733 45.4014C26.9699 47.7503 26.9402 50.2141 26.8396 52.3649C26.5498 56.6638 26.1363 59.8122 26.1363 59.8122C26.1363 59.8122 28.4364 57.5804 30.265 53.1728C30.7189 52.0772 31.1687 50.8411 31.4563 49.4748C31.7462 48.1044 32.0338 46.6082 31.9682 44.9879C31.9682 43.3938 31.7719 41.6312 31.139 39.9196C30.881 39.0478 30.3523 38.2399 29.9432 37.3916C29.7022 36.9822 29.3848 36.6156 29.1056 36.2278L28.6642 35.6544L28.4408 35.3792L28.3894 35.3069C28.4107 35.341 28.4577 35.3836 28.5406 35.4859L28.5193 35.4456L28.4404 35.3454C28.0522 34.8211 27.2935 34.0708 27.2062 33.7424C27.0315 33.3546 26.7651 33.0413 26.5901 32.4465C26.17 31.4299 25.8527 30.2598 25.682 29.0681C25.324 26.6851 25.3728 24.2192 25.4689 22.0621C25.7521 17.7437 26.1275 14.5935 26.1275 14.5935C26.1275 14.5935 23.8534 16.8507 22.0244 21.2414C21.1079 23.4325 20.3 26.1692 20.2593 29.3814C20.2996 30.9712 20.3257 32.7129 20.9883 34.4329C21.1996 35.2621 21.692 36.2275 22.2035 37.1568Z"
              fill={theme.palette.primary.main}
            />
            <path
              d="M38.3459 22.5508C38.9002 23.5804 39.2668 23.868 39.746 24.5585L40.974 26.0379C41.2084 26.528 41.575 26.9331 41.7368 27.4746C42.1378 28.4998 42.5744 29.5975 42.7109 30.7977C43.1071 33.1528 43.0774 35.6169 42.9776 37.7633C42.698 42.0729 42.2783 45.2106 42.2783 45.2106C42.2783 45.2106 44.574 42.981 46.3982 38.5756C46.8565 37.4716 47.3067 36.2502 47.594 34.8604C47.8886 33.4984 48.1715 32.0106 48.1098 30.3864C48.1054 28.8028 47.9183 27.0252 47.2766 25.318C47.0187 24.4506 46.49 23.6343 46.0809 22.7923C45.8402 22.381 45.5265 22.0144 45.241 21.6222L44.8062 21.0509L44.578 20.7739L44.5311 20.7017C44.5483 20.7358 44.5993 20.7827 44.6569 20.84L44.5736 20.7442C44.1943 20.2155 43.4311 19.474 43.3478 19.1412C43.1691 18.7574 42.9024 18.4441 42.7281 17.8409C42.308 16.8286 41.9862 15.6542 41.8241 14.4713C41.4704 12.0795 41.5151 9.62234 41.6109 7.46093C41.8949 3.14177 42.2739 0 42.2739 0C42.2739 0 39.9954 2.25314 38.1668 6.63944C37.2587 8.82213 36.4424 11.5673 36.398 14.7795C36.4427 16.3612 36.4681 18.115 37.1226 19.8394C37.342 20.6686 37.83 21.6299 38.3459 22.5508Z"
              fill={theme.palette.primary.main}
            />
            <path
              d="M58.2665 37.1476C58.8121 38.1709 59.183 38.4626 59.6563 39.1469L60.884 40.6262C61.1144 41.1208 61.4809 41.5171 61.6471 42.0671C62.0522 43.0988 62.487 44.1899 62.6235 45.3901C63.0197 47.7474 62.99 50.2093 62.8876 52.3513C62.6106 56.6653 62.1887 59.7986 62.1887 59.7986C62.1887 59.7986 64.4906 57.5778 66.3152 53.1592C66.7713 52.0677 67.2189 50.8294 67.4999 49.459C67.7982 48.0908 68.084 46.5986 68.0202 44.9744C68.0158 43.3864 67.8283 41.6216 67.1888 39.9122C66.9331 39.0342 66.3959 38.2223 65.9905 37.3803C65.752 36.9734 65.4365 36.6109 65.1635 36.2186L64.7159 35.6518L64.4902 35.3685L64.4389 35.2941C64.4686 35.3238 64.5071 35.3773 64.5838 35.4775L64.5713 35.4434L64.4862 35.3285C64.098 34.8086 63.3349 34.0624 63.2582 33.7322C63.0707 33.3506 62.815 33.0288 62.6359 32.4297C62.218 31.4174 61.8985 30.2429 61.7322 29.0597C61.3742 26.6726 61.4208 24.2063 61.5191 22.0493C61.7921 17.7415 62.1755 14.5935 62.1755 14.5935C62.1755 14.5935 59.8992 16.8463 58.079 21.2414C57.1625 23.4325 56.348 26.167 56.3139 29.3748C56.348 30.9584 56.3737 32.7085 57.0344 34.4241C57.252 35.253 57.7422 36.2227 58.2665 37.1476Z"
              fill={theme.palette.primary.main}
            />
            <path
              d="M74.6185 105.105C75.0621 104.401 75.4756 103.604 75.8719 102.752C78.1951 104.026 80.8639 104.755 83.6901 104.755C92.6851 104.755 100 97.4357 100 88.4451C100 79.4461 92.6807 72.1353 83.6901 72.1353C82.6925 72.1353 81.7291 72.2332 80.7784 72.4079C80.595 67.4118 79.8149 63.9482 78.4636 63.9482C75.5776 63.9482 57.4773 63.9482 47.5295 63.9482C47.5295 63.9482 44.8801 63.9482 40.9902 63.9482C31.0365 63.9482 12.9381 63.9482 10.0542 63.9482C6.03665 63.9482 7.04049 94.2297 13.8993 105.104C18.4988 112.389 25.2619 118.583 29.2244 121.892C14.7777 121.892 2.92459 121.892 0.854904 121.892C-4.84013 121.892 19.2601 134.603 33.4214 134.603C47.5805 134.603 42.7315 134.603 55.354 134.603C67.9725 134.603 94.9265 121.892 90.5273 121.892C88.7838 121.892 75.3046 121.892 59.2883 121.892C63.2582 118.584 70.015 112.39 74.6185 105.105ZM80.4721 82.3318C81.4396 81.8163 82.5223 81.4964 83.6901 81.4964C87.5184 81.4964 90.6345 84.6172 90.6345 88.4451C90.6345 92.273 87.5184 95.3847 83.6901 95.3847C81.7933 95.3847 80.0839 94.6175 78.8261 93.3814C79.5977 89.8177 80.1433 86.0023 80.4721 82.3318ZM29.6409 110.979C27.9913 109.231 26.2052 107.061 24.5468 104.546C22.8308 102.065 21.3474 99.1961 19.9895 96.2719C19.4315 94.7455 18.7578 93.2794 18.3036 91.7443C17.8068 90.2224 17.3955 88.7093 17.1119 87.2002C16.7817 85.7165 16.5322 84.2672 16.4489 82.8605C16.3403 81.4582 16.1782 80.1788 16.2783 78.9086C16.3124 76.4023 16.5983 74.4456 16.9688 73.094C17.2822 71.7258 17.5188 70.9498 17.5188 70.9498C17.5188 70.9498 17.7617 71.7258 18.0901 73.0896C18.2434 73.7632 18.4313 74.5902 18.6445 75.5368C18.9193 76.4489 19.2388 77.4509 19.499 78.5381C19.7356 79.6123 20.2599 80.789 20.5817 82.0251C20.9141 83.2656 21.4813 84.5274 21.9095 85.8574C22.3061 87.2002 22.9798 88.509 23.4549 89.894C23.9216 91.2882 24.6209 92.6311 25.1878 94.0125C25.759 95.3935 26.3923 96.762 27.008 98.1133C27.7198 99.4092 28.2037 100.807 28.8814 102.061C30.1365 104.644 31.3114 107.061 32.3152 109.124C34.368 113.281 35.7043 116.24 35.7043 116.24C35.7043 116.24 32.9063 114.508 29.6409 110.979Z"
              fill={theme.palette.primary.main}
            />
          </svg>
          <H2Text styles={{ color: theme.palette.primary.main, textDecoration: 'none' }}>Come back to us soon!</H2Text>
        </PopupContentContainer>
      </PopupBlockContainer>
    </PopupBackgroundContainer>
  );
};

export default LogoutPopup;
